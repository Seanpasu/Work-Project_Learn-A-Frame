---
layout: environment_basic
---
<a-scene xr-mode-ui="enabled: true" webxr="optionalFeatures: local-floor, bounded-floor, hand-tracking">
	<a-assets>
		<video id="video" autoplay="true" loop="true" src="assets/videos/sharks.mp4"></video>
	</a-assets>

	<!-- Add Hand models for tracking visualization -->
	<a-camera>
		<a-entity id="left-hand" hand-tracking="hand: left" raycaster="objects: .clickable; showline: true; lineColor: rgba(173, 216, 230, 0.5)" position="0 1 -2" gesture-listener="hand: left"></a-entity>
		<a-entity id="right-hand" hand-tracking="hand: right" raycaster="objects: .clickable; showline: true; lineColor: rgba(173, 216, 230, 0.5)" position="0 1 -2" gesture-listener="hand: right"></a-entity>
	</a-camera>

	<!-- Video -->
	<a-videosphere class="clickable video" src="#video" play-on-click></a-videosphere>

	<script>
		AFRAME.registerComponent('play-on-click', {
			init: function () {
				this.onClick = this.onClick.bind(this);
			},
			play: function () {
				window.addEventListener('click', this.onClick);
			},
			pause: function () {
				window.removeEventListener('click', this.onClick);
			},
			onClick: function (evt) {
				var videoEl = this.el.getAttribute('material').src;
				if (!videoEl) { return; }
				this.el.object3D.visible = true;
				videoEl.play();
			}
		});

		AFRAME.registerComponent('gesture-listener', {
			schema: {
				hand: { type: "string" }
			},
			init: function () {
				this.el.addEventListener('hand-tracking-updated', (event) => {
					const handData = event.detail.hand;

					// pointing gesture
					const isPointing = handData.fingers[1].extended && handData.fingers.slice(2).every(finger => !finger.extended);

					if (isPointing) {	// Enable clicking and make line opaque when pointing
						this.el.setAttribute("raycaster", "enabled", true);
						this.el.setAttribute("line", "color", "rgba(0, 255, 0, 1)");
					} else {	// Disable clicking and make line transparent when not pointing
						this.el.setAttribute("raycaster", "enabled", false);
						this.el.setAttribute("line", "color", "rgba(173, 216, 20, 0.5)")
					}
				});
			}
		});

		// Video click interactions
		document.querySelector(".video").addEventListener("click", function () {
			if (this.paused) {
				this.play();
			} else {
				this.pause();
			}
		});
	</script>


</a-scene>